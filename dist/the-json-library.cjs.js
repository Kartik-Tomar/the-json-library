"use strict";function e(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var r,t,n,a,o,i;var s=e(function(){if(i)return o;i=1;const e=function(){if(t)return r;t=1;const e=(r,t,i,s)=>{if(t.type&&!n(r,t.type))return s.push({path:i||"root",message:`Expected type ${t.type}, got ${Array.isArray(r)?"array":typeof r}`}),!1;if(t.required&&Array.isArray(t.required))for(const e of t.required)null!=r&&e in r||s.push({path:i?`${i}.${e}`:e,message:`Missing required property '${e}'`});if(t.properties&&"object"==typeof t.properties)for(const n in t.properties){const a=t.properties[n],o=i?`${i}.${n}`:n;r&&void 0!==r[n]&&e(r[n],a,o,s)}if("array"===t.type&&t.items&&Array.isArray(r))for(let n=0;n<r.length;n++){const a=i?`${i}[${n}]`:`[${n}]`;e(r[n],t.items,a,s)}return t.enum&&Array.isArray(t.enum)&&(t.enum.some((e=>o(e,r)))||s.push({path:i||"root",message:`Value must be one of the enum values: ${JSON.stringify(t.enum)}`})),"number"!==t.type&&"integer"!==t.type||(void 0!==t.minimum&&r<t.minimum&&s.push({path:i||"root",message:`Value ${r} is less than minimum ${t.minimum}`}),void 0!==t.maximum&&r>t.maximum&&s.push({path:i||"root",message:`Value ${r} is greater than maximum ${t.maximum}`})),"string"===t.type&&(void 0!==t.minLength&&r.length<t.minLength&&s.push({path:i||"root",message:`String length ${r.length} is less than minLength ${t.minLength}`}),void 0!==t.maxLength&&r.length>t.maxLength&&s.push({path:i||"root",message:`String length ${r.length} is greater than maxLength ${t.maxLength}`}),t.pattern&&!new RegExp(t.pattern).test(r)&&s.push({path:i||"root",message:`String does not match pattern: ${t.pattern}`})),t.format&&"string"===t.type&&(a(r,t.format)||s.push({path:i||"root",message:`Value does not match format: ${t.format}`})),0===s.length},n=(e,r)=>{if(null===e)return"null"===r;switch(r){case"string":return"string"==typeof e;case"number":return"number"==typeof e&&!isNaN(e);case"integer":return"number"==typeof e&&Number.isInteger(e);case"boolean":return"boolean"==typeof e;case"array":return Array.isArray(e);case"object":return"object"==typeof e&&!Array.isArray(e)&&null!==e;case"null":return null===e;default:return!0}},a=(e,r)=>{switch(r){case"email":return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e);case"date-time":return!isNaN(Date.parse(e));case"date":return/^\d{4}-\d{2}-\d{2}$/.test(e)&&!isNaN(Date.parse(e));case"uri":try{return new URL(e),!0}catch{return!1}default:return!0}},o=(e,r)=>{if(e===r)return!0;if("object"!=typeof e||"object"!=typeof r||null===e||null===r)return!1;const t=Object.keys(e),n=Object.keys(r);if(t.length!==n.length)return!1;for(const a of t)if(!n.includes(a)||!o(e[a],r[a]))return!1;return!0};return r=({schema:r,data:t})=>{const n=[];return e(t,r,"",n),{isValid:0===n.length,errors:n}}}(),s=function(){if(a)return n;a=1;const e=(r,t="")=>{if("object"!=typeof r||null===r)throw new Error(`Schema at ${t||"root"} must be an object`);if(r.properties){if("object"!=typeof r.properties||null===r.properties)throw new Error(`Properties at ${t||"root"} must be an object`);for(const n in r.properties)e(r.properties[n],t?`${t}.${n}`:n)}if(r.items&&e(r.items,t?`${t}.items`:"items"),void 0!==r.required){if(!Array.isArray(r.required))throw new Error(`Required at ${t||"root"} must be an array`);for(const e of r.required)if("string"!=typeof e)throw new Error(`Required items at ${t||"root"} must be strings`)}if(void 0!==r.enum&&!Array.isArray(r.enum))throw new Error(`Enum at ${t||"root"} must be an array`);if(void 0!==r.minimum&&"number"!=typeof r.minimum)throw new Error(`Minimum at ${t||"root"} must be a number`);if(void 0!==r.maximum&&"number"!=typeof r.maximum)throw new Error(`Maximum at ${t||"root"} must be a number`);if(void 0!==r.minLength&&(!Number.isInteger(r.minLength)||r.minLength<0))throw new Error(`MinLength at ${t||"root"} must be a non-negative integer`);if(void 0!==r.maxLength&&(!Number.isInteger(r.maxLength)||r.maxLength<0))throw new Error(`MaxLength at ${t||"root"} must be a non-negative integer`);if(void 0!==r.pattern)try{new RegExp(r.pattern)}catch(e){throw new Error(`Invalid regex pattern at ${t||"root"}: ${r.pattern}`)}};return n=r=>{let t;if("string"==typeof r)try{t=JSON.parse(r)}catch(e){throw new Error(`Invalid schema JSON: ${e.message}`)}else{if("object"!=typeof r||null===r)throw new Error("Schema must be a valid JSON object or string");t=r}return e(t),t}}();return o={validate:({schema:r,data:t})=>{try{const n=s(r);if(!n)throw new Error("Schema is required");if(!t)throw new Error("Data is required");const a=e({schema:n,data:t});if(!a.isValid)throw new Error(a?.errors?.map((e=>`${e?.path}: ${e?.message}`)));return!0}catch(e){return{valid:!1,error:e?.message}}},parseValidationSchema:s}}());module.exports=s;
